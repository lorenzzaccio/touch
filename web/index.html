<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
    <head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8">
        <link rel="stylesheet" href="./css/myStyle.css" type="text/css" />
        <title>Stock Manager</title>
        <script type="text/javascript" src="jquery/jquery-1.7.2.js"></script>
        <script type="text/javascript" src="jquery/jquery.svg.js"></script>
        <script type="text/javascript" src="jquery/jquery.svgdom.js"></script>
        <script type="text/javascript" src="lib/fontdetect.js"></script>
        <script type="text/javascript" src="lib/combobox.js"></script>
        <script type="text/javascript" src="lib/textbox.js"></script>
        <script type="text/javascript" src="lib/slider.js"></script>
        <script type="text/javascript" src="lib/label.js"></script>
        <script type="text/javascript" src="lib/button.js"></script>
        <script type="text/javascript" src="lib/colourPicker.js"></script>
        <script type="text/javascript" src="lib/mapApp.js"></script>
        <script type="text/javascript" src="lib/timer.js"></script>
        <script type="text/javascript" src="lib/guiCbk.js"></script>
        <script type="text/javascript" src="lib/util.js"></script>
        <script type="text/javascript" src="lib/menu.js"></script>
        <script type="text/javascript" src="lib/graphic.js"></script>
        <script type="text/javascript" src="lib/helper_functions.js"></script>
        <script type="text/javascript" src="lib/cookie.js"></script>
        <script type="text/javascript" src="lib/table.js"></script>
        <script type="text/javascript" src="lib/gui.js"></script>
        <script type="text/javascript" src="lib/forme.js"></script>
        
       

        <script type="text/javascript">
            //global vars
            var arrec = [];
            var g;
            var selectedItem;
            var menuSvg;
            var globalVar;
            var myGraph;

            $(function(){
                $('#svgbasics').svg({onLoad: drawInitial});
                
            });

            function drawInitial(svg) {
                var svg = $('#svgbasics').svg('get');
                initEventHandler();
                myGraph = new graphic(g,globalVar);
                initialize();
                //create a table named "myTable" with a header row (tableHeader) and attach it to the div "footer"
                //var tableHeader = loadHeader();
                //createHeader("footer","myTable",tableHeader);
                //read cookies and put them in myTable
                //readCookie();
                loadArrayFromCookie();
                drawcaps();
                //var group = drawRect("g_pal1","orange","purple",20,200,120,70,0,0);
                //drawRect("rect2","green","orange",200,200,70,70,0,0);
                //drawRect("rect3","red","orange",500,500,70,70,0,0);
            }
            
            
            function drawcaps() {
                //var tableId = "myTable";
                //myGraph.updateViewBox();
                var displayList = []; 
                
                $('#svgbasics').svg('get').clear();
                g = $('#svgbasics').svg('get').group({id: 'mainGroup'});
                
                var arrow = [];
                var rowLength = 0;
                //if(document.getElementById(tableId)!= null)
                //    rowLength = document.getElementById(tableId).rows.length;    
                rowLength = arrec.length;
                if(rowLength>0){
                    var k =0;
                    for(var j = 0 ; j< rowLength;j++){
                        //arrow= readRow(tableId,j);
                        arrow = arrec[j];
                        if(arrow[COL_NUMBER-2]!=null){
                            displayList[k] = j;
                            k++;
                        }
                    }
                    for(var j = 0 ; j<= 100;j++){
                        for(var l = 0 ; l< k;l++){//on demarre Ã  1 car 0 c'est le header'
                            //arrow= readRow(tableId,displayList[l]);
                            arrow = arrec[displayList[l]];
                            if(arrow[COL_NUMBER-1] == j){
                                if(activeView == "ROOM")
                                    filter="room";
                                if(activeView == "CARTON")
                                    filter=selectedPalette;
                                //alert(arrow[FORME_HEADER]+" - "+arrow[VIEW_HEADER]);
                                
                                if((arrow[FORME_HEADER] == "rectangle")&&(arrow[VIEW_HEADER]==filter)){
                                    var id = arrow[ID_HEADER];//posx
                                    var x = arrow[X_HEADER];//posx
                                    var y = arrow[Y_HEADER];//posy
                                    var height = arrow[HEIGHT_HEADER];//posy
                                    var width = arrow[WIDTH_HEADER];//posy
                                    var transx = arrow[TRANSX_HEADER];//transx
                                    var transy = arrow[TRANSY_HEADER];//transy
                                    var texte = arrow[TEXTE_HEADER];//texte
                                    var fillColor = arrow[FILLCOLOR_HEADER];//color
                                    var strokeColor = arrow[STROKECOLOR_HEADER];//stroke color
                                    var quantite = arrow[QUANTITE_HEADER];//quantity
                                    
                                    var group = drawRect(arrow);
                                    drawText(group,id,strokeColor,texte,0,x-(-5),y-(-height));
                                    drawText(group,id,strokeColor,quantite,1,x-(-5),y-(-height));
                                    
                                    }
                          }
                        }
                      }
                    
                    for(var j = 0 ; j< rowLength;j++){
                        //arrow= readRow(tableId,j);
                        arrow = arrec[j];
                    }
                }else{
                    //alert("tbl is null");
                }
                
            }
            
                
        </script>
        
    </head>
    <body>
       <div id="page_container">
            <div id="header">
                <h1>Capsule Designer</h1>
            </div>
            
            <div id="left_column"></div>
            <INPUT TYPE=button id ="refreshBtn" SIZE=40 VALUE="refresh" onClick="addPalette()">
            <div id="svgrow">
                <div id="svgbasics"></div>
                <div id="svgmenu" >
                        <svg id="mainMenu"  viewBox="0 0 1024 768" width="100%" height="100%"  xmlns:xlink="http://www.w3.org/1999/xlink" onload="initialize()" zoomAndPan="disable" xml:space="preserve">	
                            <g id="mainBackground"/>
                            <defs>
                            <!-- Symbol for Slider -->
                            <symbol id="sliderSymbol" overflow="visible">
                                <line x1="0" y1="-40" x2="0" y2="40" stroke="green" stroke-width="50" pointer-events="none"/>
                            </symbol>
                            <symbol id="sliderSymbolCp" overflow="visible">
                                <line x1="0" y1="-40" x2="0" y2="40" stroke="gray" stroke-width="20" pointer-events="none"/>
                            </symbol>
                            
                        </defs>
                            <defs>
                                <symbol id="vertsliderSymbol" overflow="visible">
                                <line x1="0" y1="-30" x2="0" y2="30" stroke="red" stroke-width="25" pointer-events="none"/>
                            </symbol>
                            </defs>
                            <defs>
                                <symbol id="horisliderSymbol" overflow="visible">
                                <line x1="0" y1="-30" x2="0" y2="30" stroke="red" stroke-width="25" pointer-events="none"/>
                            </symbol>
                            </defs>
                            <text id="resultText" x="100" y="530" xml:space="preserve">ResultText</text>	
                            <g id="combo1"/>
                            <g id="textbox2"/>
                            <g id="textbox3"/>
                            <g id="zoomslider" />
                            <g id="vertslider" />
                            <g id="horislider" />
                            <g id="textbuttons"/>
                            <g id="colourPickers" />
                            
                        </svg>
                </div>
            </div>
            <div id ="right_column">
                
            </div>
            
            <div id="footer"></div>
            
            <div id="log" style="display:none;">
                <input type="text" name="txtarea" />
            </div>
            
            <div id="msg"></div>
            
        </div>
    </body>
</html>
